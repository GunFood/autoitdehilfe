<!DOCTYPE html>
<html>
<head>
<title>Funktion _DateAdd</title>
<meta charset="utf-8">
<link href="../css/default.css" rel="stylesheet">
</head>

<body>
<h1 class="small">Funktionreferenz</h1>
<hr style="height:0px">
<div class="top"><h1>_DateAdd</h1><div>
<div id="flagtext">Beschreibung anzeigen in</div>
<div id="flaglink"> <a href="../libfunctions_en/_DateAdd.htm"><img src="../images/Flagge_en.png" height="29" width="36" border=0 hspace=10/></a></div>
<br style="clear: both;">
<p style="margin:2px 0 0 0;" class="funcdesc">Berechnet ein neues Datum bzw. eine neues Uhrzeit durch das addieren bzw. subvtrahieren von Zeitintervallen basierend auf einem gegebenen Datum bzw. einer gegebenen Uhrzeit<br /></p>
<p class="codeheader">
#include &lt;Date.au3&gt;<br />
_DateAdd ( $sType, $vNumber, $sDate )<br />
</p>

<h2>Parameter</h2>
<table>
<tr>
<td style="width:15%">$sType</td>
<td style="width:85%">zu verwendende Zeitintervalle:<br />
D - Addiert eine Anzahl von Tagen zu dem angegebenen Datum hinzu bzw. subtrahiert diese davon<br />
M - Addiert eine Anzahl von Monaten zu dem angegebenen Datum hinzu bzw. subtrahiert diese davon<br />
Y - Addiert eine Anzahl von Jahren zu dem angegebenen Datum hinzu bzw. subtrahiert diese davon<br />
w - Addiert eine Anzahl von Wochen zu dem angegebenen Datum hinzu bzw. subtrahiert diese davon<br />
h - Addiert eine Anzahl von Stunden zu dem angegebenen Datum hinzu bzw. subtrahiert diese davon<br />
n - Addiert eine Anzahl von Minuten zu dem angegebenen Datum hinzu bzw. subtrahiert diese davon<br />
s - Addiert eine Anzahl von Sekunden zu dem angegebenen Datum hinzu bzw. subtrahiert diese davon<br />
a - Addiert eine Anzahl von Tagen, Stunden, Minuten und Sekunden zu dem angegebenen Datum hinzu bzw. subtrahiert diese davon</td>
</tr>
<tr>
<td>$vNumber</td>
<td>Anzahl von Intervallen die addiert oder subtrahiert werden sollen (f&uuml;r Subtraktion ist ein Minus zu verwenden)<br />
oder ein $vNumber[4] f&uuml;r zu addierende bzw. subtrahierende Werte [Tagen, Stunden, Minuten, Sekunden] </td>
</tr>
<tr>
<td>$sDate</td>
<td>Ausgangsdatum im Format YYYY/MM/DD[ hh:mm:ss]</td>
</tr>
</table>

<h2>R&uuml;ckgabewert</h2>
<table class="noborder">
<tr>
<td style="width:10%" class="valign-top">Erfolg:</td>
<td style="width:90%">berechnetes Datum.</td>
</tr>
<tr>
<td class="valign-top">Fehler:</td>
<td>0 und setzt das @error Flag auf ungleich 0</td>
</tr>
<tr>
<td class="valign-top">@error:</td>
<td>1 - $sType ung&uuml;ltig<br />
2&nbsp;- $vNumber ung&uuml;ltig<br />
3&nbsp;- $sDate ung&uuml;ltig</td>
</tr>
</table>

<h2>Bemerkungen</h2>
<p>Ein g&uuml;ltiges Ausgangsdatum muss zwischen "2000/01/01 00:00:00" und "3000/12/31 23:59:59" liegen.<br />
<br />
Diese Funktion gibt kein ung&uuml;ltiges Datum zur&uuml;ck. 2004/01/31 + 3 Monate ergibt 2004/04/30.<br />
<br />
Siehe <a href="_DateTimeSplit.htm">_DateTimeSplit()</a> f&uuml;r andere m&ouml;gliche Datumsformate.<br />
Das Datum muss in der Form YYYY-MM-DD hh:mm:ss angegeben werden. Statt "-" kann auch "/" oder "." als Trennzeichen verwendet werden.<br />
Die Angabe von "hh:mm:ss" ist optional.<br />
</p>

<h2>Verwandte Funktionen</h2>
<p><a href="_DateDiff.htm">_DateDiff</a>, <a href="_DateTimeSplit.htm">_DateTimeSplit</a>, <a href="_DateToDayOfWeek.htm">_DateToDayOfWeek</a>, <a href="_DateToDayOfWeekISO.htm">_DateToDayOfWeekISO</a>, <a href="_DateToDayValue.htm">_DateToDayValue</a>, <a href="_DayValueToDate.htm">_DayValueToDate</a></p>

<h2 class="bottom">Beispiel</h2>
<script type="text/javascript">
if ((navigator.appName == "Microsoft Internet Explorer") && (parseInt(navigator.appVersion) >= 4)) // IE (4+) only
function copyToClipboard(section) {
if (window.clipboardData && clipboardData.setData) {
clipboardData.setData("text", section + "\r\n");
alert("Das Beispiel wurde in die Zwischenablage kopiert");
}
}
</script>
<h3>Beispiel 1</h3>
<div class="codeSnippetContainer">
	<div class="codeSnippetContainerTabs">
<script type="text/javascript">
if (document.URL.match(/^mk:@MSITStore:/i)) {
document.write('<div class="codeSnippetContainerTab codeSnippetContainerTabSingle" dir="ltr">');
document.write('<object id=hhctrl type="application/x-oleobject" classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11"><param name="Command" value="ShortCut"><param name="Font" value="Verdana,10pt"><param name="Text" value="Text:Dieses Skript &ouml;ffnen"><param name="Item1" value=",Examples\\HelpFile\\_DateAdd.au3,"></object>');
document.write('<\/div>');
}
</script>
</div>

<div class="codeSnippetContainerCodeContainer">
<div class="codeSnippetToolBar">
<div class="codeSnippetToolBarText">
<script type="text/javascript">
if ((navigator.appName == "Microsoft Internet Explorer") && (parseInt(navigator.appVersion) >= 4)) // IE (4+) only
document.write('<a href="#" id="copy" onclick="copyToClipboard(document.getElementById(\'copytext1\').innerText)">In die Zwischenablage kopieren<\/a>');
</script>
</div>
</div>
<div class="codeSnippetContainerCode" dir="ltr" id="copytext1">
<pre>
<span><a class="codeSnippetLink" href="../keywords/include.htm"><span class="S11">#include</span></a><span class="S0"> </span><span class="S7">&lt;Date.au3&gt;</span>
<a class="codeSnippetLink" href="../keywords/include.htm"><span class="S11">#include</span></a><span class="S0"> </span><span class="S7">&lt;MsgBoxConstants.au3&gt;</span>

<span class="S1">; Addiert zum heutigen Datum 5 Tage dazu</span>
<a class="codeSnippetLink" href="../keywords/Dim.htm"><span class="S5">Local</span></a><span class="S0"> </span><span class="S9">$sNewDate</span><span class="S0"> </span><a class="codeSnippetLink" href="../intro/lang_operators.htm"><span class="S8">=</span></a><span class="S0"> </span><a class="codeSnippetLink" href="../libfunctions/_DateAdd.htm"><span class="S15">_DateAdd</span></a><span class="S8">(</span><span class="S7">'d'</span><span class="S8">,</span><span class="S0"> </span><span class="S3">5</span><span class="S8">,</span><span class="S0"> </span><a class="codeSnippetLink" href="../libfunctions/_NowCalcDate.htm"><span class="S15">_NowCalcDate</span></a><span class="S8">())</span>
<a class="codeSnippetLink" href="../functions/MsgBox.htm"><span class="S4">MsgBox</span></a><span class="S8">(</span><span class="S9">$MB_SYSTEMMODAL</span><span class="S8">,</span><span class="S0"> </span><span class="S7">""</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Heute + 5 Tage: "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$sNewDate</span><span class="S8">)</span>

<span class="S1">; Subtrahiert vom heutigen Datum 2 Wochen</span>
<span class="S9">$sNewDate</span><span class="S0"> </span><a class="codeSnippetLink" href="../intro/lang_operators.htm"><span class="S8">=</span></a><span class="S0"> </span><a class="codeSnippetLink" href="../libfunctions/_DateAdd.htm"><span class="S15">_DateAdd</span></a><span class="S8">(</span><span class="S7">'w'</span><span class="S8">,</span><span class="S0"> </span><a class="codeSnippetLink" href="../intro/lang_operators.htm"><span class="S8">-</span></a><span class="S3">2</span><span class="S8">,</span><span class="S0"> </span><a class="codeSnippetLink" href="../libfunctions/_NowCalcDate.htm"><span class="S15">_NowCalcDate</span></a><span class="S8">())</span>
<a class="codeSnippetLink" href="../functions/MsgBox.htm"><span class="S4">MsgBox</span></a><span class="S8">(</span><span class="S9">$MB_SYSTEMMODAL</span><span class="S8">,</span><span class="S0"> </span><span class="S7">""</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Heute minus 2 Wochen: "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$sNewDate</span><span class="S8">)</span>

<span class="S1">; Addiert zur jetzigen Zeit 15 Minuten</span>
<span class="S9">$sNewDate</span><span class="S0"> </span><a class="codeSnippetLink" href="../intro/lang_operators.htm"><span class="S8">=</span></a><span class="S0"> </span><a class="codeSnippetLink" href="../libfunctions/_DateAdd.htm"><span class="S15">_DateAdd</span></a><span class="S8">(</span><span class="S7">'n'</span><span class="S8">,</span><span class="S0"> </span><span class="S3">15</span><span class="S8">,</span><span class="S0"> </span><a class="codeSnippetLink" href="../libfunctions/_NowCalc.htm"><span class="S15">_NowCalc</span></a><span class="S8">())</span>
<a class="codeSnippetLink" href="../functions/MsgBox.htm"><span class="S4">MsgBox</span></a><span class="S8">(</span><span class="S9">$MB_SYSTEMMODAL</span><span class="S8">,</span><span class="S0"> </span><span class="S7">""</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Aktuelle Zeit + 15 Minuten: "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$sNewDate</span><span class="S8">)</span>

<span class="S1">; Addiert zum 01.01.1970 1087497645 Sekunden und gibt das neue Datum zur&uuml;ck</span>
<span class="S9">$sNewDate</span><span class="S0"> </span><a class="codeSnippetLink" href="../intro/lang_operators.htm"><span class="S8">=</span></a><span class="S0"> </span><a class="codeSnippetLink" href="../libfunctions/_DateAdd.htm"><span class="S15">_DateAdd</span></a><span class="S8">(</span><span class="S7">'s'</span><span class="S8">,</span><span class="S0"> </span><span class="S3">1087497645</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"1970/01/01 00:00:00"</span><span class="S8">)</span>
<a class="codeSnippetLink" href="../functions/MsgBox.htm"><span class="S4">MsgBox</span></a><span class="S8">(</span><span class="S9">$MB_SYSTEMMODAL</span><span class="S8">,</span><span class="S0"> </span><span class="S7">""</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Datum: "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$sNewDate</span><span class="S8">)</span>
<span class="S0"></span></span>
</pre>
</div>
</div>
</div>
<h3>Beispiel 2 Skript mit $sType = „a“</h3><div class="codeSnippetContainer">
	<div class="codeSnippetContainerTabs">
<script type="text/javascript">
if (document.URL.match(/^mk:@MSITStore:/i)) {
document.write('<div class="codeSnippetContainerTab codeSnippetContainerTabSingle" dir="ltr">');
document.write('<object id=hhctrl type="application/x-oleobject" classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11"><param name="Command" value="ShortCut"><param name="Font" value="Verdana,10pt"><param name="Text" value="Text:Dieses Skript &ouml;ffnen"><param name="Item1" value=",Examples\\HelpFile\\_DateAdd[02].au3,"></object>');
document.write('<\/div>');
}
</script>
</div>

<div class="codeSnippetContainerCodeContainer">
<div class="codeSnippetToolBar">
<div class="codeSnippetToolBarText">
<script type="text/javascript">
if ((navigator.appName == "Microsoft Internet Explorer") && (parseInt(navigator.appVersion) >= 4)) // IE (4+) only
document.write('<a href="#" id="copy" onclick="copyToClipboard(document.getElementById(\'copytext2\').innerText)">In die Zwischenablage kopieren<\/a>');
</script>
</div>
</div>
<div class="codeSnippetContainerCode" dir="ltr" id="copytext2">
<pre>
<a class="codeSnippetLink" href="../keywords/include.htm"><span class="S11">#include</span></a><span class="S0"> </span><span class="S7">&lt;Date.au3&gt;</span>
<a class="codeSnippetLink" href="../keywords/include.htm"><span class="S11">#include</span></a><span class="S0"> </span><span class="S7">&lt;MsgBoxConstants.au3&gt;</span>

<a class="codeSnippetLink" href="../keywords/Dim.htm"><span class="S5">Local</span></a><span class="S0"> </span><span class="S9">$sStartDate</span><span class="S0"> </span><a class="codeSnippetLink" href="../intro/lang_operators.htm"><span class="S8">=</span></a><span class="S0"> </span><span class="S7">"2024/08/19 18:25:59"</span>
<a class="codeSnippetLink" href="../keywords/Dim.htm"><span class="S5">Local</span></a><span class="S0"> </span><span class="S9">$sEndDate</span><span class="S0"> </span><a class="codeSnippetLink" href="../intro/lang_operators.htm"><span class="S8">=</span></a><span class="S0"> </span><span class="S7">"2024/08/20 16:25:00"</span>

<a class="codeSnippetLink" href="../keywords/Dim.htm"><span class="S5">Local</span></a><span class="S0"> </span><span class="S9">$aDiffDate</span><span class="S0"> </span><a class="codeSnippetLink" href="../intro/lang_operators.htm"><span class="S8">=</span></a><span class="S0"> </span><a class="codeSnippetLink" href="../libfunctions/_DateDiff.htm"><span class="S15">_DateDiff</span></a><span class="S8">(</span><span class="S7">"a"</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$sStartDate</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$sEndDate</span><span class="S8">)</span>

<a class="codeSnippetLink" href="../keywords/Dim.htm"><span class="S5">Local</span></a><span class="S0"> </span><span class="S9">$sAddDate</span><span class="S0"> </span><a class="codeSnippetLink" href="../intro/lang_operators.htm"><span class="S8">=</span></a><span class="S0"> </span><a class="codeSnippetLink" href="../libfunctions/_DateAdd.htm"><span class="S15">_DateAdd</span></a><span class="S8">(</span><span class="S7">"a"</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$aDiffDate</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$sStartDate</span><span class="S8">)</span>

<a class="codeSnippetLink" href="../keywords/Dim.htm"><span class="S5">Local</span></a><span class="S0"> </span><span class="S9">$iError</span><span class="S0"> </span><a class="codeSnippetLink" href="../intro/lang_operators.htm"><span class="S8">=</span></a><span class="S0"> </span><span class="S3">0</span>
<a class="codeSnippetLink" href="../keywords/If.htm"><span class="S5">If</span></a><span class="S0"> </span><span class="S9">$sAddDate</span><span class="S0"> </span><a class="codeSnippetLink" href="../intro/lang_operators.htm"><span class="S8">&lt;&gt;</span></a><span class="S0"> </span><span class="S9">$sEndDate</span><span class="S0"> </span><a class="codeSnippetLink" href="../keywords/IfElseEndIf.htm"><span class="S5">Then</span></a><span class="S0"> </span><span class="S9">$iError</span><span class="S0"> </span><a class="codeSnippetLink" href="../intro/lang_operators.htm"><span class="S8">=</span></a><span class="S0"> </span><span class="S9">$MB_ICONERROR</span>
<a class="codeSnippetLink" href="../functions/MsgBox.htm"><span class="S4">MsgBox</span></a><span class="S8">(</span><span class="S9">$MB_SYSTEMMODAL</span><span class="S0"> </span><a class="codeSnippetLink" href="../intro/lang_operators.htm"><span class="S8">+</span></a><span class="S0"> </span><span class="S9">$iError</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Ergebnisse"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"$sStartDate = "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$sStartDate</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><a class="codeSnippetLink" href="../macros.htm#@CRLF"><span class="S6">@CRLF</span></a><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S8">_</span>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S7">"$sEndDate = "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$sEndDate</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><a class="codeSnippetLink" href="../macros.htm#@CRLF"><span class="S6">@CRLF</span></a><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><a class="codeSnippetLink" href="../macros.htm#@CRLF"><span class="S6">@CRLF</span></a><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S8">_</span>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S7">"$Diff Tage = "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$aDiffDate</span><span class="S8">[</span><span class="S3">0</span><span class="S8">]</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><a class="codeSnippetLink" href="../macros.htm#@CRLF"><span class="S6">@CRLF</span></a><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S8">_</span>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S7">"$Diff Stunden = "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$aDiffDate</span><span class="S8">[</span><span class="S3">1</span><span class="S8">]</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><a class="codeSnippetLink" href="../macros.htm#@CRLF"><span class="S6">@CRLF</span></a><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S8">_</span>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S7">"$Diff Minuten = "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$aDiffDate</span><span class="S8">[</span><span class="S3">2</span><span class="S8">]</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><a class="codeSnippetLink" href="../macros.htm#@CRLF"><span class="S6">@CRLF</span></a><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S8">_</span>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S7">"$Diff Sekunden = "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$aDiffDate</span><span class="S8">[</span><span class="S3">3</span><span class="S8">]</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><a class="codeSnippetLink" href="../macros.htm#@CRLF"><span class="S6">@CRLF</span></a><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><a class="codeSnippetLink" href="../macros.htm#@CRLF"><span class="S6">@CRLF</span></a><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S8">_</span>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S7">"F&uuml;gt Datum hinzu = "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$sAddDate</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><a class="codeSnippetLink" href="../macros.htm#@TAB"><span class="S6">@TAB</span></a><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S8">(</span><span class="S9">$iError</span><span class="S0"> </span><span class="S8">?</span><span class="S0"> </span><span class="S7">"&lt;&lt;&lt; KO &gt;&gt;&gt;"</span><span class="S8">:</span><span class="S0"> </span><span class="S7">"OK"</span><span class="S8">))</span>
<span class="S0"></span></span>
</pre>
</div>
</div>
</div>
</body>
</html>
