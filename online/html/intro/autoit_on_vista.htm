<!DOCTYPE html>
<html>
<head>
	<title>AutoIt unter Windows Vista</title>
	<meta charset="utf-8">
	<link href="../css/default.css" rel="stylesheet">
</head>
<body>
	<h1>AutoIt unter Windows Vista und neuer</h1>
	<p>Mit Windows Vista wurden neue Sicherheitsfunktionen in Windows eingef&uuml;hrt, um das Ausf&uuml;hren von Dateien, die Administratorrechte ben&ouml;tigen, zu erschweren. Auch User mit Administratorrechten werden jedesmal um Erlaubnis gefragt, wenn eine ausf&uuml;hrbare Datei versucht, administrative Operationen auszuf&uuml;hren (wie z.B. Schreibzugriffe in die Registry unter HKEY_LOCAL_MACHINE oder ins Verzeichnis C:\Windows). Das wird als <strong>Benutzerkontensteuerung (UAC)</strong> bezeichnet.</p>
	<p>Standardm&auml;&szlig;ig starten AutoIt-Skripte mit normalen Benutzerrechten, aber AutoIt erlaubt dem Skriptautor, sein Skript so zu "kennzeichnen", dass es AutoIt mitteilt, ob es Adminrechte ben&ouml;tigt oder nicht.</p>
	<p>Um ein Skript mit Adminrechten auszustatten, kann die <strong>#RequireAdmin</strong>-Direktive am Anfang des Skripts eingetragen werden:</p>
@@SyntaxHighlighting@@
; Dieses Skript ben√∂tigt volle Administratorrechte<br>
#RequireAdmin

#include <MsgBoxConstants.au3>
  
MsgBox(0, "Info", "Dieses Skript hat Adminrechte! ")
@@End@@

  <p>&nbsp;</p>
	<p>Wenn das Skript ausgef&uuml;hrt wird, pr&uuml;ft AutoIt, ob es bereits Adminrechte hat. Wenn nicht, veranlasst AutoIt das Betriebssystem, mittels UAC die Genehmigung vom Benutzer einzuholen. Verweigert der die Genehmigung, wird das Skript beendet.</p>
	<p></p>
	<h2>UAC Aufforderungen</h2>
	<p>Im Folgenden sind die Abfragen aufgef&uuml;hrt, die angezeigt werden, wenn ein Programm mit administrativen Rechten gestartet wird. Die Art der Abfrage h&auml;ngt davon ab, ob der Benutzer ein "Eingeschr&auml;nkter Benutzer" oder ein "Computeradministrator" ist (man erinnere sich, dass auch Administratoren ihre Erlaubnis f&uuml;r administrative Operationen geben m&uuml;ssen).<br>
	Beachte: Die gezeigten Abfragen sind f&uuml;r die digital signierte AutoIt-Version - alle freigegebenen Versionen sind signiert, aber Betaversionen sind es m&ouml;glicherweise nicht und erzeugen eine Warnung wie im Abschnitt "Kompilierte Skripte" weiter unten.</p>
	<p></p>
	<p><strong>Abfrage bei eingeschr&auml;nktem Benutzer</strong></p>
	<p><img alt="" src="../images/autoit_standarduser_uac_signed.png"></p>
	<p>Ein eingeschr&auml;nkter Benutzer muss einen Benutzernamen und ein Passwort eingeben, um fortzufahren und das Skript mit erweiterten Rechten auszuf&uuml;hren.</p>
	<p></p>
	<p><strong>Abfrage bei Computeradministrator</strong></p>
	<p><img alt="" src="../images/autoit_uac_signed.png"></p>
	<p>Wenn der Benutzer bereits als Administrator angemeldet ist, wird nur seine Best&auml;tigung verlangt - es ist keine Passworteingabe notwendig.</p>
	<h2>Kompilierte Skripte</h2>
	<p>Kompilierte Skripte (und m&ouml;glicherweise Betaversionen von AutoIt) sind <strong>nicht</strong> digital signiert und erzeugen eine ernsthafter aussehende Warnung:</p>
	<p><img alt="" src="../images/compiled_uac_unsigned.png"></p>
	<p>Der Benutzer muss auf <strong>Erlauben</strong> klicken um fortzufahren (oder als eingeschr&auml;nkter Benutzer das Passwort eingeben).</p>
	<p>Wenn man eine eigene Authenticode-Signatur besitzt, kann man seine eigenen kompilierten Skripte selbst signieren.</p>
	<p></p>
	<p><strong>Wichtig: Egal ob AutoIt oder ein kompiliertes Skript signiert ist oder nicht, sollte man nur Skripte starten, die aus einer Quelle stammen, der man vertraut!</strong></p>
	<p><strong>Auch signierter Code kann b&ouml;sartig sein!</strong></p>
</body>
</html>
