<!DOCTYPE html>
<html>
<head>
<title>Funktion _WinAPI_CreateDesktop</title>
<meta charset="utf-8">
<link href="../css/default.css" rel="stylesheet" type="text/css" id="theme" />
	<script type="text/javascript">
		var aThemes = new Array('default.css','dark.css');
		var aImages = new Array('dark.png','default.png');
			
		class Themes {
			static theme = document.getElementById('theme').getAttribute('href').split('/')[1];
			static index = 0;
			static getTheme() {
				return this.theme;
			}
			static setTheme(name) {
				this.index = (name == 'default') ? 1 : 0;
				this.toggleTheme();
			}
			static storeTheme(idx) {
				this.theme = aThemes[idx];				
				document.getElementById('theme').setAttribute('href', '../css/' + this.theme);
				document.getElementById('toggleButton').src = '../images/' + aImages[idx];
			}
			static toggleTheme() {
				this.index = Math.abs(this.index -1);
				if (this.theme != aThemes[this.index]) {
					this.storeTheme(this.index);
				}
				// *** NUR hier im Test zur Anzeige geladenes Theme ***
				// *** document.getElementById('nameTheme').innerText = aThemes[this.index];
			}
		}		

		function getURLParameter(name) {
			var value = decodeURIComponent((RegExp(name + '=' + '(.+?)(&|$)').exec(location.search) || [, ""])[1]);
			return (value !== 'null') ? value : false;
		}
		
		// -- Wenn Seite geladen: auf Theme-Parameter pr√ºfen. Wenn anderes Theme: Wechseln. --
		window.addEventListener('load', function(){
			var themeCurrent = Themes.getTheme();
			var param = getURLParameter('Theme'); 
			if (param && themeCurrent != param) {
				Themes.setTheme(param);
			}
			// *** NUR hier im Test zur Anzeige Parameter ***
			// *** document.getElementById('info').innerText = param;
		})	
	</script>	
</head>

<body>
<h1 class="small">Funktionreferenz</h1>
<hr style="height:0px">
<div class="top"><h1>_WinAPI_CreateDesktop</h1><div>
<div ><input id="toggleButton" type="image" onclick="Themes.toggleTheme()" src="../images/dark.png" height ="36" width="36" alt="Toggle Theme"></div><br />
<br style="clear: both;">
<p style="margin:2px 0 0 0;" class="funcdesc">Creates a new desktop, associates it with the current window station of the calling process<br /></p>
<p class="codeheader">
#include &lt;WinAPISys.au3&gt;<br />
_WinAPI_CreateDesktop ( $sName [, $iAccess = 0x0002 [, $iFlags = 0 [, $iHeap = 0 [, $tSecurity = 0]]]] )<br />
</p>

<h2>Parameter</h2>
<table>
<tr>
<td style="width:15%">$sName</td>
<td style="width:85%">The name of the desktop to be created. Desktop names are case-insensitive and may not contain backslash characters (\).</td>
</tr>
<tr>
<td>$iAccess</td>
<td><strong>[optional]</strong> The requested access to the desktop. This parameter can be one or more of the following values:<br />
&nbsp;&nbsp;&nbsp; $DESKTOP_ALL_ACCESS<br />
&nbsp;&nbsp;&nbsp; $DESKTOP_CREATEMENU<br />
&nbsp;&nbsp;&nbsp; $DESKTOP_CREATEWINDOW (Default)<br />
&nbsp;&nbsp;&nbsp; $DESKTOP_ENUMERATE<br />
&nbsp;&nbsp;&nbsp; $DESKTOP_HOOKCONTROL<br />
&nbsp;&nbsp;&nbsp; $DESKTOP_JOURNALPLAYBACK<br />
&nbsp;&nbsp;&nbsp; $DESKTOP_JOURNALRECORD<br />
&nbsp;&nbsp;&nbsp; $DESKTOP_READOBJECTS<br />
&nbsp;&nbsp;&nbsp; $DESKTOP_SWITCHDESKTOP<br />
&nbsp;&nbsp;&nbsp; $DESKTOP_WRITEOBJECTS</td>
</tr>
<tr>
<td>$iFlags</td>
<td><strong>[optional]</strong> The optional flags. It can be zero or the following value:<br />
&nbsp;&nbsp;&nbsp; $DF_ALLOWOTHERACCOUNTHOOK</td>
</tr>
<tr>
<td>$iHeap</td>
<td><strong>[optional]</strong> The size of the desktop heap, in kilobytes. Default is 0.</td>
</tr>
<tr>
<td>$tSecurity</td>
<td><strong>[optional]</strong> $tagSECURITY_ATTRIBUTES structure that determines whether the returned handle can be inherited by child processes.<br />
If this parameter is 0 (Default), the handle cannot be inherited .</td>
</tr>
</table>

<h2>R&uuml;ckgabewert</h2>
<table class="noborder">
<tr>
<td style="width:10%" class="valign-top">Success:</td>
<td style="width:90%">Handle to the newly created desktop. If the specified desktop already exists, the function succeeds and returns a handle to the existing desktop.</td>
</tr>
<tr>
<td class="valign-top">Failure:</td>
<td>0, call <a href="_WinAPI_GetLastError.htm" onclick="location.href = this.href + '?Theme=' + Themes.getTheme();return false">_WinAPI_GetLastError()</a> to get extended error information.</td>
</tr>
</table>

<h2>Bemerkungen</h2>
<p>The number of desktops that can be created is limited by the size of the system desktop heap.<br />
You can increase the number of desktops that can be created by increasing the size of the desktop heap or by reducing the default heap reserved for each desktop in the interactive window station.<br />
The default size of the desktop heap depends on factors such as hardware architecture.<br />
To retrieve the size of the heap, call the <a href="_WinAPI_GetUserObjectInformation.htm" onclick="location.href = this.href + '?Theme=' + Themes.getTheme();return false">_WinAPI_GetUserObjectInformation()</a> function with $UOI_HEAPSIZE.<br />
<br />
When you are finished using the desktop, call the <a href="_WinAPI_CloseDesktop.htm" onclick="location.href = this.href + '?Theme=' + Themes.getTheme();return false">_WinAPI_CloseDesktop()</a> function to close it.<br />
</p>

<h2>Verwandte Funktionen</h2>
<p><a href="_WinAPI_CloseDesktop.htm" onclick="location.href = this.href + '?Theme=' + Themes.getTheme();return false">_WinAPI_CloseDesktop</a>, <a href="_WinAPI_GetUserObjectInformation.htm" onclick="location.href = this.href + '?Theme=' + Themes.getTheme();return false">_WinAPI_GetUserObjectInformation</a></p>

<h2>Siehe auch</h2>
<p>Suche nach <a href="http://msdn.microsoft.com/query/dev10.query?appId=Dev10IDEF1&l=EN-US&k=k(CreateDesktopEx);k(DevLang-C);k(TargetOS-WINDOWS)&rd=true">CreateDesktopEx</a> in der MSDN Bibliothek.
</p>

<h2 class="bottom">Beispiel</h2>
<script type="text/javascript">
if ((navigator.appName == "Microsoft Internet Explorer") && (parseInt(navigator.appVersion) >= 4)) // IE (4+) only
function copyToClipboard(section) {
if (window.clipboardData && clipboardData.setData) {
clipboardData.setData("text", section + "\r\n");
alert("Das Beispiel wurde in die Zwischenablage kopiert");
}
}
</script>
<div class="codeSnippetContainer">
	<div class="codeSnippetContainerTabs">
<script type="text/javascript">
if (document.URL.match(/^mk:@MSITStore:/i)) {
document.write('<div class="codeSnippetContainerTab codeSnippetContainerTabSingle" dir="ltr">');
document.write('<object id=hhctrl type="application/x-oleobject" classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11"><param name="Command" value="ShortCut"><param name="Font" value="Verdana,10pt"><param name="Text" value="Text:Dieses Skript &ouml;ffnen"><param name="Item1" value=",Examples\\HelpFile\\_WinAPI_CreateDesktop.au3,"></object>');
document.write('<\/div>');
}
</script>
</div>

<div class="codeSnippetContainerCodeContainer">
<div class="codeSnippetToolBar">
<div class="codeSnippetToolBarText">
<script type="text/javascript">
if ((navigator.appName == "Microsoft Internet Explorer") && (parseInt(navigator.appVersion) >= 4)) // IE (4+) only
document.write('<a href="#" id="copy" onclick="copyToClipboard(document.getElementById(\'copytext1\').innerText)">In die Zwischenablage kopieren<\/a>');
</script>
</div>
</div>
<div class="codeSnippetContainerCode" dir="ltr" id="copytext1">
<pre>
<span><a class="codeSnippetLink" href="../keywords/include.htm" onclick="location.href = this.href + '?Theme=' + Themes.getTheme();return false"><span class="S11">#include</span></a><span class="S0"> </span><span class="S7">&lt;MsgBoxConstants.au3&gt;</span>
<a class="codeSnippetLink" href="../keywords/include.htm" onclick="location.href = this.href + '?Theme=' + Themes.getTheme();return false"><span class="S11">#include</span></a><span class="S0"> </span><span class="S7">&lt;WinAPIMem.au3&gt;</span>
<a class="codeSnippetLink" href="../keywords/include.htm" onclick="location.href = this.href + '?Theme=' + Themes.getTheme();return false"><span class="S11">#include</span></a><span class="S0"> </span><span class="S7">&lt;WinAPIProc.au3&gt;</span>
<a class="codeSnippetLink" href="../keywords/include.htm" onclick="location.href = this.href + '?Theme=' + Themes.getTheme();return false"><span class="S11">#include</span></a><span class="S0"> </span><span class="S7">&lt;WinAPISys.au3&gt;</span>

<span class="S1">; Retrieve a handle to the current desktop and create a new desktop named "MyDesktop"</span>
<a class="codeSnippetLink" href="../keywords/Dim.htm" onclick="location.href = this.href + '?Theme=' + Themes.getTheme();return false"><span class="S5">Local</span></a><span class="S0"> </span><span class="S9">$hPrev</span><span class="S0"> </span><a class="codeSnippetLink" href="../intro/lang_operators.htm" onclick="location.href = this.href + '?Theme=' + Themes.getTheme();return false"><span class="S8">=</span></a><span class="S0"> </span><a class="codeSnippetLink" href="../libfunctions/_WinAPI_GetThreadDesktop.htm" onclick="location.href = this.href + '?Theme=' + Themes.getTheme();return false"><span class="S15">_WinAPI_GetThreadDesktop</span></a><span class="S8">(</span><a class="codeSnippetLink" href="../libfunctions/_WinAPI_GetCurrentThreadId.htm" onclick="location.href = this.href + '?Theme=' + Themes.getTheme();return false"><span class="S15">_WinAPI_GetCurrentThreadId</span></a><span class="S8">())</span>
<a class="codeSnippetLink" href="../keywords/Dim.htm" onclick="location.href = this.href + '?Theme=' + Themes.getTheme();return false"><span class="S5">Local</span></a><span class="S0"> </span><span class="S9">$hDesktop</span><span class="S0"> </span><a class="codeSnippetLink" href="../intro/lang_operators.htm" onclick="location.href = this.href + '?Theme=' + Themes.getTheme();return false"><span class="S8">=</span></a><span class="S0"> </span><a class="codeSnippetLink" href="../libfunctions/_WinAPI_CreateDesktop.htm" onclick="location.href = this.href + '?Theme=' + Themes.getTheme();return false"><span class="S15">_WinAPI_CreateDesktop</span></a><span class="S8">(</span><span class="S7">'MyDesktop'</span><span class="S8">,</span><span class="S0"> </span><a class="codeSnippetLink" href="../functions/BitOR.htm" onclick="location.href = this.href + '?Theme=' + Themes.getTheme();return false"><span class="S4">BitOR</span></a><span class="S8">(</span><span class="S9">$DESKTOP_CREATEWINDOW</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$DESKTOP_SWITCHDESKTOP</span><span class="S8">))</span>
<a class="codeSnippetLink" href="../keywords/If.htm" onclick="location.href = this.href + '?Theme=' + Themes.getTheme();return false"><span class="S5">If</span></a><span class="S0"> </span><a class="codeSnippetLink" href="../intro/lang_operators.htm" onclick="location.href = this.href + '?Theme=' + Themes.getTheme();return false"><span class="S5">Not</span></a><span class="S0"> </span><span class="S9">$hDesktop</span><span class="S0"> </span><a class="codeSnippetLink" href="../keywords/IfElseEndIf.htm" onclick="location.href = this.href + '?Theme=' + Themes.getTheme();return false"><span class="S5">Then</span></a>
<span class="S0">&nbsp; &nbsp; </span><a class="codeSnippetLink" href="../functions/MsgBox.htm" onclick="location.href = this.href + '?Theme=' + Themes.getTheme();return false"><span class="S4">MsgBox</span></a><span class="S8">((</span><span class="S9">$MB_ICONERROR</span><span class="S0"> </span><a class="codeSnippetLink" href="../intro/lang_operators.htm" onclick="location.href = this.href + '?Theme=' + Themes.getTheme();return false"><span class="S8">+</span></a><span class="S0"> </span><span class="S9">$MB_SYSTEMMODAL</span><span class="S8">),</span><span class="S0"> </span><span class="S7">'Error'</span><span class="S8">,</span><span class="S0"> </span><span class="S7">'Unable to create desktop.'</span><span class="S8">)</span>
<span class="S0">&nbsp; &nbsp; </span><a class="codeSnippetLink" href="../keywords/Exit.htm" onclick="location.href = this.href + '?Theme=' + Themes.getTheme();return false"><span class="S5">Exit</span></a>
<a class="codeSnippetLink" href="../keywords/IfElseEndIf.htm" onclick="location.href = this.href + '?Theme=' + Themes.getTheme();return false"><span class="S5">EndIf</span></a>

<span class="S1">; Switch to the newly created desktop</span>
<a class="codeSnippetLink" href="../libfunctions/_WinAPI_SwitchDesktop.htm" onclick="location.href = this.href + '?Theme=' + Themes.getTheme();return false"><span class="S15">_WinAPI_SwitchDesktop</span></a><span class="S8">(</span><span class="S9">$hDesktop</span><span class="S8">)</span>

<span class="S1">; Run "notepad.exe" on "MyDesktop" and wait until a process will not be closed by user</span>
<a class="codeSnippetLink" href="../keywords/Dim.htm" onclick="location.href = this.href + '?Theme=' + Themes.getTheme();return false"><span class="S5">Local</span></a><span class="S0"> </span><span class="S9">$pText</span><span class="S0"> </span><a class="codeSnippetLink" href="../intro/lang_operators.htm" onclick="location.href = this.href + '?Theme=' + Themes.getTheme();return false"><span class="S8">=</span></a><span class="S0"> </span><a class="codeSnippetLink" href="../libfunctions/_WinAPI_CreateString.htm" onclick="location.href = this.href + '?Theme=' + Themes.getTheme();return false"><span class="S15">_WinAPI_CreateString</span></a><span class="S8">(</span><span class="S7">'MyDesktop'</span><span class="S8">)</span>
<a class="codeSnippetLink" href="../keywords/Dim.htm" onclick="location.href = this.href + '?Theme=' + Themes.getTheme();return false"><span class="S5">Local</span></a><span class="S0"> </span><span class="S9">$tProcess</span><span class="S0"> </span><a class="codeSnippetLink" href="../intro/lang_operators.htm" onclick="location.href = this.href + '?Theme=' + Themes.getTheme();return false"><span class="S8">=</span></a><span class="S0"> </span><a class="codeSnippetLink" href="../functions/DllStructCreate.htm" onclick="location.href = this.href + '?Theme=' + Themes.getTheme();return false"><span class="S4">DllStructCreate</span></a><span class="S8">(</span><a class="codeSnippetLink" href="$tagPROCESS_INFORMATION.htm" onclick="location.href = this.href + '?Theme=' + Themes.getTheme();return false"><span class="S9">$tagPROCESS_INFORMATION</span></a><span class="S8">)</span>
<a class="codeSnippetLink" href="../keywords/Dim.htm" onclick="location.href = this.href + '?Theme=' + Themes.getTheme();return false"><span class="S5">Local</span></a><span class="S0"> </span><span class="S9">$tStartup</span><span class="S0"> </span><a class="codeSnippetLink" href="../intro/lang_operators.htm" onclick="location.href = this.href + '?Theme=' + Themes.getTheme();return false"><span class="S8">=</span></a><span class="S0"> </span><a class="codeSnippetLink" href="../functions/DllStructCreate.htm" onclick="location.href = this.href + '?Theme=' + Themes.getTheme();return false"><span class="S4">DllStructCreate</span></a><span class="S8">(</span><a class="codeSnippetLink" href="$tagSTARTUPINFO.htm" onclick="location.href = this.href + '?Theme=' + Themes.getTheme();return false"><span class="S9">$tagSTARTUPINFO</span></a><span class="S8">)</span>
<a class="codeSnippetLink" href="../functions/DllStructSetData.htm" onclick="location.href = this.href + '?Theme=' + Themes.getTheme();return false"><span class="S4">DllStructSetData</span></a><span class="S8">(</span><span class="S9">$tStartup</span><span class="S8">,</span><span class="S0"> </span><span class="S7">'Size'</span><span class="S8">,</span><span class="S0"> </span><a class="codeSnippetLink" href="../functions/DllStructGetSize.htm" onclick="location.href = this.href + '?Theme=' + Themes.getTheme();return false"><span class="S4">DllStructGetSize</span></a><span class="S8">(</span><span class="S9">$tStartup</span><span class="S8">))</span>
<a class="codeSnippetLink" href="../functions/DllStructSetData.htm" onclick="location.href = this.href + '?Theme=' + Themes.getTheme();return false"><span class="S4">DllStructSetData</span></a><span class="S8">(</span><span class="S9">$tStartup</span><span class="S8">,</span><span class="S0"> </span><span class="S7">'Desktop'</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$pText</span><span class="S8">)</span>
<a class="codeSnippetLink" href="../keywords/If.htm" onclick="location.href = this.href + '?Theme=' + Themes.getTheme();return false"><span class="S5">If</span></a><span class="S0"> </span><a class="codeSnippetLink" href="../libfunctions/_WinAPI_CreateProcess.htm" onclick="location.href = this.href + '?Theme=' + Themes.getTheme();return false"><span class="S15">_WinAPI_CreateProcess</span></a><span class="S8">(</span><span class="S7">''</span><span class="S8">,</span><span class="S0"> </span><a class="codeSnippetLink" href="../macros.htm" onclick="location.href = this.href + '?Theme=' + Themes.getTheme();return false"#@SystemDir><span class="S6">@SystemDir</span></a><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">'\notepad.exe'</span><span class="S8">,</span><span class="S0"> </span><span class="S3">0</span><span class="S8">,</span><span class="S0"> </span><span class="S3">0</span><span class="S8">,</span><span class="S0"> </span><span class="S3">0</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$CREATE_NEW_PROCESS_GROUP</span><span class="S8">,</span><span class="S0"> </span><span class="S3">0</span><span class="S8">,</span><span class="S0"> </span><span class="S3">0</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$tStartup</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$tProcess</span><span class="S8">)</span><span class="S0"> </span><a class="codeSnippetLink" href="../keywords/IfElseEndIf.htm" onclick="location.href = this.href + '?Theme=' + Themes.getTheme();return false"><span class="S5">Then</span></a>
<span class="S0">&nbsp; &nbsp; </span><a class="codeSnippetLink" href="../functions/ProcessWaitClose.htm" onclick="location.href = this.href + '?Theme=' + Themes.getTheme();return false"><span class="S4">ProcessWaitClose</span></a><span class="S8">(</span><a class="codeSnippetLink" href="../functions/DllStructGetData.htm" onclick="location.href = this.href + '?Theme=' + Themes.getTheme();return false"><span class="S4">DllStructGetData</span></a><span class="S8">(</span><span class="S9">$tProcess</span><span class="S8">,</span><span class="S0"> </span><span class="S7">'ProcessID'</span><span class="S8">))</span>
<a class="codeSnippetLink" href="../keywords/IfElseEndIf.htm" onclick="location.href = this.href + '?Theme=' + Themes.getTheme();return false"><span class="S5">EndIf</span></a>

<span class="S1">; Switch to previous desktop and close "MyDesktop"</span>
<a class="codeSnippetLink" href="../libfunctions/_WinAPI_SwitchDesktop.htm" onclick="location.href = this.href + '?Theme=' + Themes.getTheme();return false"><span class="S15">_WinAPI_SwitchDesktop</span></a><span class="S8">(</span><span class="S9">$hPrev</span><span class="S8">)</span>
<a class="codeSnippetLink" href="../libfunctions/_WinAPI_CloseDesktop.htm" onclick="location.href = this.href + '?Theme=' + Themes.getTheme();return false"><span class="S15">_WinAPI_CloseDesktop</span></a><span class="S8">(</span><span class="S9">$hDesktop</span><span class="S8">)</span>

<span class="S1">; Free memory allocated for a string</span>
<a class="codeSnippetLink" href="../libfunctions/_WinAPI_FreeMemory.htm" onclick="location.href = this.href + '?Theme=' + Themes.getTheme();return false"><span class="S15">_WinAPI_FreeMemory</span></a><span class="S8">(</span><span class="S9">$pText</span><span class="S8">)</span>
<span class="S0"></span></span>
</pre>
</div>
</div>
</div>
</body>
</html>
